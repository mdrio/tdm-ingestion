language: python
python:
  - "3.6"

cache: pip

services:
  - docker

env:
  global:
    - IMG=tdmproject/tdm-ingestion
  matrix:
    - CONF=sync
#    - CONF=async


install:
  - pip install -e .[$CONF]
  - pip install kafka

script:
  - cd tests
  - python -m unittest
  - cd -
  - make tests

deploy:
  - provider: script
    script: bash .travis/push.sh
    on:
      repo: tdm-project/tdm-ingestion
      branch: master
